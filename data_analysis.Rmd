---
title: "Data Analysis"
author: "Group 4 - Jonathan Che and David Green"
date: ""
output: 
  pdf_document:
    fig_height: 3
    fig_width: 5
  html_document:
    fig_height: 3
    fig_width: 5
  word_document:
    fig_height: 3
    fig_width: 5
---


```{r, include=FALSE}
# Don't delete this chunk if you are using the mosaic package
# This loads the mosaic and dplyr packages
require(mosaic)
require(readr)
require(rpart) # for classification trees
require(class) # for kNN methods
require(randomForest) # for random forests
require(ggplot2)
```

```{r, include=FALSE}
# Some customization.  You can alter or delete as desired (if you know what you are doing).

# This changes the default colors in lattice plots.
trellis.par.set(theme=theme.mosaic())  

# knitr settings to control how R chunks work.
require(knitr)
opts_chunk$set(
  tidy=FALSE,     # display code as typed
  size="small"    # slightly smaller font for code
)

```{r, include=FALSE}
# Load additional packages here.  Uncomment the line below to use Project MOSAIC data sets.
# require(mosaicData)   
```

```{r, include=FALSE}
df2 <- read_csv("babynames3.csv")
```

## Data Cleaning

```{r}
df3 <- df2
df3 <- data.frame(lapply(df3[,1:3], function(x) as.factor(x)),
                  df3[,4:6],
                  lapply(df3[,7:8], function(x) as.factor(x)),
                  df3[,9:10],
                  lapply(df3[,11:13], function(x) as.logical(x)),
                  df3[14:40])

df4 <- df3 %>%
  select(-count, -rank, -name)
# Think about year

df2011 <- df4 %>%
  filter(year == "2011")
```

## Visualizations

```{r}
# Insignificant differences unless otherwise noted
ggplot(df4, aes(x=race, y=name_length)) +
  geom_boxplot()
ggplot(df4, aes(x=race, y=vowel_consonant_prop)) +
  geom_boxplot()
ggplot(df4, aes(x=race, y=num_syllables)) +
  geom_boxplot()
ggplot(df4, aes(x=race, y=name_length)) +
  geom_boxplot()

ggplot(df4, aes(x=name_length, y=num_syllables, color=race)) +
  geom_jitter()
```


## Simple Tree

```{r}
df2011a <- df2011 %>%
  select(gender, name_length, vowel_consonant_prop, double_letter, double_vowel, double_consonant, num_syllables)

bf.control=rpart.control(minsplit=100,minbucket=20,xval=5)
bf.treeorig=rpart(gender ~.,data=df2011a,method="class",control=bf.control)
plot(bf.treeorig)
text(bf.treeorig,cex=.7)
printcp(bf.treeorig)
```

